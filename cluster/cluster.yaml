apiVersion: ctlptl.dev/v1alpha1
kind: Cluster
product: k3d
registry: ctlptl-registry
kindV1Alpha4Cluster:
  name: task-app-cluster
  
  k3dClusterConfig:
    servers: 1
    agents: 2
    
    ports:
      - port: 8080:80
        nodeFilters:
          - loadbalancer
      - port: 8443:443
        nodeFilters:
          - loadbalancer
    
    options:
      k3d:
        wait: true
        timeout: "120s"
      k3s:
        extraArgs:
          - arg: --disable=traefik
            nodeFilters:
              - server:*
      kubeconfig:
        updateDefaultKubeconfig: true
        switchCurrentContext: true
